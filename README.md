# Malware Analysis Lab (Zeus Banking Trojan) / Work in progress

## Objective

My goal for this lab is to refine my expertise in malware analysis, deepening my knowledge and understanding of this critical cybersecurity domain while honing essential skills for identifying, dissecting, and mitigating malicious software threats.

### Skills Learned

- Fingerprinting 
- Basic static analysis 
- Advanced static analysis
- Basic dynamic analysis
- New tools
- 

### Tools Used

- Oracle VM
- Flare VM
- Remnux VM
- Virus Total
- PeStudio
- Floss
- Capa
- Cutter
- INetSim
- Wireshark
- Process Monitor(Procmon)
- Yara

## Steps
- I start my analysis in my FlareVM by downloading the Zeus Banking Trojan here https://github.com/ytisf/theZoo/blob/master/malware/Binaries/ZeusBankingVersion_26Nov2013/ZeusBankingVersion_26Nov2013.zip
![VirtualBox_FlareVM-windows-10_19_03_2024_18_36_02](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/46c4e7f8-0b8d-4413-9c7a-90408d4fcee2)
- Switching from a Bridged Adapter to a Host-only Adapter cutting off the internet to the machine
![Screenshot 2024-03-19 183433](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/5f18ab8c-34b0-47cb-a7ab-145a602f560b)
- Extracting the file through 7zip and then opening the archive I move the file to the desktop and am ready to analyze 
![VirtualBox_FlareVM-windows-10_19_03_2024_18_55_00](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/89fb5d0d-991b-45f6-9015-01f7442308eb)
- I switched back to a Bridged Adapter and uploaded the file to VirusTotal for a thorough virus analysis. But, I made sure to switch back to a host-only adapter afterwards.
![VirtualBox_FlareVM-windows-10_19_03_2024_19_09_54](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/fff15ae8-afc0-42b6-87d8-616f7968f13a)
- Going to PEstudio I collect the hash information of the virus
![VirtualBox_FlareVM-windows-10_19_03_2024_19_41_35](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/7319885f-c545-492b-beb2-c1fa0d7100c9)
- Scrolling down In PeStudio I find something interesting I can add to my report 
![Screenshot 2024-03-19 195254](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/0d3f6b20-fc13-4084-9a75-a244200fe8e5)
- using Floss in the cmder command line I am going to deobfuscate the executable
![VirtualBox_FlareVM-windows-10_19_03_2024_20_31_31](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/573bc0e6-c944-4645-b480-f28c67a5306c)
- I also run this command here to ouput strings above 6 characters
![VirtualBox_FlareVM-windows-10_19_03_2024_20_40_52](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/a8b51d7c-dc61-4da0-8dec-cbf12b23675d)
- Here I run the tool Capa against the virus 
![VirtualBox_FlareVM-windows-10_19_03_2024_20_55_02](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/888bb1b5-cc70-437e-95c0-6289c99e4994)
- capa -v .\invoice_2318362983713_823931342io.pdf.exe for my analysis
![VirtualBox_FlareVM-windows-10_19_03_2024_21_10_44](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/52a99991-5c4b-4afd-b83a-8c458db2d8b2)
- Using cutter I analyze the executable
![VirtualBox_FlareVM-windows-10_19_03_2024_21_46_13](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/77a4e5a9-1623-4312-8bbe-d5da06c1f08a)
- After analyzing the executable, I opened Procmon and ran INetSim in the Remnux VM.
![VirtualBox_FlareVM-windows-10_20_03_2024_19_04_36](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/3f8540a1-6c5f-4b18-8e45-b9f5cd933d8a)
![VirtualBox_REMnux_20_03_2024_19_04_50](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/07ff3fa0-a985-4759-84ce-3d5ecc45ebe1)
- I can confirm that INetSim is working properly
![VirtualBox_FlareVM-windows-10_20_03_2024_19_05_16](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/218214bc-4199-4675-8191-112773cdd9e2)
- Now I am ready to detonate the executable and in this image, you can see that the executable deleted itself from the Desktop 
![VirtualBox_FlareVM-windows-10_20_03_2024_19_14_50](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/64772b8c-1672-4780-b729-dfb892e35da7)
- Here I do some filtering in Procmon
![VirtualBox_FlareVM-windows-10_20_03_2024_19_40_38](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/bacf9b91-1974-4d42-91d0-9d0d990fca3d)
- Once I finsih with Procmon I open up Wireshark and collect network packets on the ethernet adapter
![VirtualBox_FlareVM-windows-10_20_03_2024_21_20_10](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/d9beb659-bde7-40d5-8ab1-8fe896f96cfb)
- Finishing Up my analysis I write a Yara rule
![VirtualBox_FlareVM-windows-10_20_03_2024_22_41_10](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/c56aa979-2ba5-40b5-8e7e-8f861e1e68c2)
- I continue and run my yara rule in cmder
![VirtualBox_FlareVM-windows-10_20_03_2024_22_41_23](https://github.com/Jpouncil23/Malware-Analysis-Lab-/assets/163768012/eb58b4ea-cbfd-4693-88e4-e1944fb9ea7b)














